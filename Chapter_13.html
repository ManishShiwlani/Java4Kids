<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Creating a Ping-Pong Game</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Noto Serif", "DejaVu Serif", serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Open Sans", "DejaVu Sans", sans-serif; font-weight: 300; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #7a2518; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #19407c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2 { letter-spacing: -0.01em; }

dt, th.tableblock, td.content { text-rendering: optimizeLegibility; }

p, td.content { letter-spacing: -0.01em; }
p strong, td.content strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
  * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after, a[href^="mailto:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img { page-break-inside: avoid; }
  thead { display: table-header-group; }
  img { max-width: 100% !important; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  .sect1 { padding-bottom: 0 !important; }
  .sect1 + .sect1 { border: 0 !important; }
  #header > h1:first-child { margin-top: 1.25rem; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { background: none !important; padding: 0 0.9375em; }
  #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="book">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_creating-a-ping-pong-game"><a class="anchor" href="#_creating-a-ping-pong-game"></a>Creating a Ping-Pong Game</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In chapters 6, 7, and 10 you’ve learned how to create simple GUI with JavaFX using such components as buttons, labels and text fields. In this chapter we&#8217;ll use JavaFX again, but this time you&#8217;ll be drawing and animating shapes.</p>
</div>
<div class="paragraph">
<p>JavaFX includes the package <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/scene/shape/package-summary.html">javafx.scene.shape</a>, which includes such classes as <code>Circle</code>, <code>Rectangle</code>, <code>Line</code> and more. All of these classes are inherited from the class <code>Shape</code>.</p>
</div>
<div class="paragraph">
<p>Ping-Pong is a perfect game to illustrate the drawing and animating capabilities of JavaFX. In this game you&#8217;ll have another chance to work with event handlers, and will learn how to move (animate) shapes around the stage.</p>
</div>
<div class="sect2">
<h3 id="_the-strategy"><a class="anchor" href="#_the-strategy"></a>The Strategy</h3>
<div class="paragraph">
<p>Let’s come up with some rules of our Ping-Pong game:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This game will have two players named Kid and Computer. The table should be painted green, the left paddle should be painted blue - it&#8217;ll be controlled by the Computer. The right paddle should be yellow - it&#8217;s controlled by the Kid. Initially the red ball should be located in the center of the table.</p>
</li>
<li>
<p>A new game starts when a player presses the N-key on the keyboard, pressing Q will end the game, and the S-key will serve the ball. Only the kid can serve the ball.</p>
</li>
<li>
<p>The Kid’s paddle movements should be controlled by the Up and Down arrow keys. Pressing the key once should move the paddle vertically by the preset number of pixels up or down. The paddle shouldn&#8217;t cross the table borders.</p>
</li>
<li>
<p>The Kid can move the right paddle and press the S-key. This should serve the ball from the position where the right paddle is located. The ball cam move at an angle, which means that its x and y coordinate should change while moving. If the ball crosses the top or bottom borders of the table, the Kid loses a point.</p>
</li>
<li>
<p>While the ball is moving to the left, the Computer should move the left paddle in the direction of the ball movement.</p>
</li>
<li>
<p>If the ball touches the left paddle, it should bounce and start moving to the right. When the Computer bounces the ball, it can move only horizontally to the right.</p>
</li>
<li>
<p>If the ball contacts the Kid’s paddle in the upper half of the table, the ball should be moving in the up-and-left direction.  If the ball was located in the bottom part of the table, it should move in the down-and-left direction.The game lasts until one of the players reaches the score of 21. Since the computer can&#8217;t serve the ball, the Kid should score a point if the ball crosses the left border of the table. If the ball crosses the top or
bottom table borders the point is given to the computer.The computer can also earn the point if it bounces the ball and it crosses the right border of the table. These rules are not the same as in a real Ping-Pong game, but they are good enough for our game.</p>
</li>
<li>
<p>The game score should be displayed in the left bottom corner of the table.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At first, it seems to be a very challenging task. In programming we often have to break the complicated problem into a set of smaller and simpler tasks. The ability to do so is called <em>analytical thinking</em>, and it helps not only in programming, but  everywhere in your life. Do not get frustrated if you can’t achieve a big goal, split it in a set of the smaller ones an reach them one at time!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start breaking our complex task. Try to visualize a ping-pong table. Can you write a program that will draw a green rectangle? That’s our first goal to achieve. Then we&#8217;ll add the paddle. Then we&#8217;ll see how to draw the ball. Learning how to move the ball will be the next task. Writing the keyboard event handlers shouldn&#8217;t be too difficult.</p>
</div>
<div id="FIG13-1" class="imageblock">
<div class="content">
<img src="./images/fig_13_PingPong.png" alt="fig 13 PingPong">
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s implement each step from the game strategy, one step at a time.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step-1-creating-the-table"><a class="anchor" href="#_step-1-creating-the-table"></a>Step 1: Creating the Table</h3>
<div class="paragraph">
<p>In this section or goal is to draw a 2D ping-pong table, which should look as a green rectangle.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with creating a new JavaFX project in IntelliJ IDEA selecting JavaFX as a project type. Press Next, and on the next popup window enter PingPong as a project name. Press the button Finish and IDEA will generate a new project for you. Rename (right-click | Refactor | Rename) the file <em>sample.fxml</em> into <em>pingpong.fxml</em>, the <code>Main</code> class into <code>PingPong</code>, and <code>Controller</code> into <code>PingPongController</code>. The same way change the name of the package from <em>sample</em> to <em>pong</em>.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s draw the ping-pong table in Scene Builder. Right-click on the file <em>pingpong.fxml</em> and open it in Scene Builder. As you&#8217;ve seen in Chapter 7, the generated FXML uses the <code>&lt;GridBag&gt;</code> as a default container, and you&#8217;ll see an empty <code>GridBag</code> in the Hierarchy pane. The left side of the SceneBuilder panels will look as follows:</p>
</div>
<div id="FIG13-2" class="imageblock">
<div class="content">
<img src="./images/fig_13_Group.png" alt="fig 13 Group">
</div>
</div>
<div class="paragraph">
<p>But I&#8217;m not going to use any layouts in the PingPong game. The game will consist of a number of shapes that I&#8217;ll keep in the <code>Group</code> container. We haven&#8217;t use it yet - the <code>Group</code> is used just to keep several child components together. Grouping components in a container can come handy, if you need to assign one event handler to all child components or auto-resize all of them as a group.</p>
</div>
<div class="paragraph">
<p>In Scene Builder delete the <code>GridBag</code> container and drag/drop the <code>Group</code> from the Miscellaneous section down to the Hierarchy panel. Then drag/drop a <code>Rectangle</code> from the Shapes panel onto the <code>Group</code>. Resize it an pick a nice green color from the Fill property on the right side. You&#8217;ll be picking a color from a dropdown palette, and the corresponding color code will be automatically inserted as a <code>fill</code> property of the <code>Rectangle</code>. Your Screen Builder should look like this:</p>
</div>
<div id="FIG13-3" class="imageblock">
<div class="content">
<img src="./images/fig_13_Rectangle.png" alt="fig 13 Rectangle">
</div>
</div>
<div class="paragraph">
<p>Open the file <em>pingpong.fxml</em> and you&#8217;ll see the tag <code>&lt;Rectangle&gt;</code> inside the <code>&lt;Group&gt;</code> generated by Scene Builder. Set the width of the <code>Rectangle</code> to 400, and the height to 250. It should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;?import javafx.scene.shape.*?&gt;
&lt;?import javafx.scene.*?&gt;
&lt;?import java.lang.*?&gt;
&lt;?import javafx.scene.layout.*?&gt;
&lt;?import javafx.geometry.Insets?&gt;
&lt;?import javafx.scene.layout.GridPane?&gt;
&lt;?import javafx.scene.control.Button?&gt;
&lt;?import javafx.scene.control.Label?&gt;

&lt;Group xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"&gt;
   &lt;children&gt;
      &lt;Rectangle arcHeight="5.0" arcWidth="5.0" fill="#31b287" height="250" stroke="BLACK" strokeType="INSIDE" width="400" /&gt;
   &lt;/children&gt;
&lt;/Group&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>archHeight</code> and <code>arcWidth</code> were auto-generated in case you need to create rounded corners in the rectangle. The properties <code>stroke</code> and <code>strokeType</code> define the look and the placement of the rectangle&#8217;s border. Every rectangle has the <code>x</code> and <code>y</code> properties that define the coordinates of its upper left corner inside the container. By default the values of <code>x</code> and <code>y</code> are zeros, so this rectangle will be drawn starting from the upper left corner of the <code>Group</code> container.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re interested in learning how different properties change the look of the rectangle visit the <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/scene/shape/Rectangle.html">online documentation</a> for this class. Keep in mind that some of the properties are defined in the class <code>Shape</code>, the ancestor of the <code>Rectangle</code>.</p>
</div>
<div class="paragraph">
<p>Running the auto-generated <code>PingPong</code> class will show the following window:</p>
</div>
<div id="FIG13-4" class="imageblock">
<div class="content">
<img src="./images/fig_13_HelloWorld.png" alt="fig 13 HelloWorld">
</div>
</div>
<div class="paragraph">
<p>There are a couple of things that I don&#8217;t like here. First, the corners of the rectangle are rounded just a little bit. This is caused by the properties <code>archHeight</code> and <code>arcWidth</code>, which are vertical and horizontal diameters of corner arcs. I&#8217;ll delete them from the table rectangle in <code>pingpong.fxml</code>.</p>
</div>
<div class="paragraph">
<p>Second, the window has a title Hello World set by the auto-generated code in IntelliJ IDEA. It&#8217;s easy to change in the class <code>PingPong</code>, but I don&#8217;t even want to see a title bar!</p>
</div>
<div class="paragraph">
<p>This is also an easy change in JavaFX. Set the stage style to <code>UNDECORATED</code> will remove the standard window title and borders. But if I&#8217;ll remove the title bar, I&#8217;ll lose the ability to close the window by clicking on the circle (or a little cross in Windows) will be gone. A bit later we&#8217;ll write the code to close the window by pressing the Q-key on the keyboard. At this point the code of the <code>PingPong</code> class looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package pong;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;
import javafx.stage.StageStyle;

public class PingPong extends Application {

 @Override
 public void start(Stage primaryStage) throws Exception{

    Parent root = FXMLLoader.load(getClass().getResource("pingpong.fxml"));

    primaryStage.setScene(new Scene(root, 400, 250));
    primaryStage.initStyle(StageStyle.UNDECORATED);
    primaryStage.show();
 }


 public static void main(String[] args) {
     launch(args);
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class was generated by IDEA, but I&#8217;ve removed the Hello World title, set the size of the scene to 400 by 250 pixels, and added the line
<code>primaryStage.initStyle(StageStyle.UNDECORATED);</code>. Running the <code>PingPong</code> class will display the following green rectangle:</p>
</div>
<div id="FIG13-5" class="imageblock">
<div class="content">
<img src="./images/fig_13_undecorated.png" alt="fig 13 undecorated">
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s open <em>pingpong.fxml</em> in Scene Builder again add the paddles and the ball on top of the table. For paddles, I&#8217;ll drag/drop two <code>Rectangle</code> objects from the Shapes section onto the Group container. Our paddles will have size of 10 by 50 pixels. The left paddle will be blue, aand the right one - yellow. Then I drag/drop, resize and color the <code>Circle</code> setting its radius to 9 pixels and painting it red. My Scene Builder will look like this:</p>
</div>
<div id="FIG13-6" class="imageblock">
<div class="content">
<img src="./images/fig_13_paddles_and_ball.png" alt="fig 13 paddles and ball">
</div>
</div>
<div class="paragraph">
<p>Now back to IDEA. Since our shapes will need to communicate with the controller class, we need to assign an <code>fx:id</code> to each of them. Let&#8217;s assign the <code>fx:id="theGroup"</code> to the <code>Group</code> container. Our green <code>Rectangle</code> will get <code>fx:id="table"</code>.</p>
</div>
<div class="paragraph">
<p>Computer will play with the left paddle, and I&#8217;ll give it <code>fx:id="compPaddle"</code>. The Kid will play with the right paddle that will go by <code>fx:id="kidPaddle"</code>. The ball will get <code>fx:id="ball"</code>. Now The <code>Group</code> container in my file <em>pingpong.fxml</em> will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;Group fx:id="theGroup" xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"&gt;
   &lt;children&gt;
      &lt;Rectangle fx:id="table" fill="#31b287" height="250" stroke="BLACK" strokeType="INSIDE" width="400" /&gt;
      &lt;Rectangle fx:id="compPaddle" arcHeight="5.0" arcWidth="5.0" fill="DODGERBLUE" height="50.0" layoutX="24.0" layoutY="98.0" stroke="BLACK" strokeType="INSIDE" width="10.0" /&gt;
      &lt;Rectangle fx:id="kidPaddle" arcHeight="5.0" arcWidth="5.0" fill="#f0ff1f" height="50.0" layoutX="365.0" layoutY="98.0" stroke="BLACK" strokeType="INSIDE" width="10.0" /&gt;
      &lt;Circle fx:id="ball" fill="#ff1f35" layoutX="191.0" layoutY="123.0" radius="9.0" stroke="BLACK" strokeType="INSIDE" /&gt;
   &lt;/children&gt;
&lt;/Group&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the <code>PingPong</code> program will display the following ping-pong table:</p>
</div>
<div id="FIG13-7" class="imageblock">
<div class="content">
<img src="./images/fig_13_table_paddles_and_ball.png" alt="fig 13 table paddles and ball">
</div>
</div>
<div class="paragraph">
<p>The GUI drawing is complete, now we need to take care of the user interactions, which will be done in the class <code>PingPongController</code>. In <em>pingpong.fxml</em> we need to assign this class as the <code>fx:controller</code> to the <code>Group</code> (see Chapter 8 for a refresher):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;Group fx:id="theGroup" fx:controller="pong.PingPongController" xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dear Scene Builder and FXML, you&#8217;ve been very helpful. Now I&#8217;m happily going back to Java programming.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step-2-handling-keyboard-events"><a class="anchor" href="#_step-2-handling-keyboard-events"></a>Step 2: Handling Keyboard Events</h3>
<div class="paragraph">
<p>We need to add the event handler methods to the class <code>PingPongController</code> to process keyboard events. Every key on the keyboard has a special code assigned, and our first goal is to figure out which key the player pressed.</p>
</div>
<div class="paragraph">
<p>For processing keyboard events JavaFX components have special event handler properties <code>onKeyPressed</code>, <code>onKeyReleased</code>, and <code>onKeyTyped</code>. The first two properties allow you to program different actions for the downward and upward key motions, if needed.</p>
</div>
<div class="paragraph">
<p>The <code>onKeyTyped</code> is used to assign a handler to the event when the key code is sent to the system output. This event is <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/scene/input/KeyEvent.html">not generated</a> for the keys that don&#8217;t produce character output. We&#8217;ll use <code>onKeyReleased</code> - this is when the the user lift his finger up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
IDEA can help you to find out which event handlers can be used with a particular component. Just click CTRL-Space inside this component&#8217;s FXML tag and start typing with the letters <code>on</code> - you&#8217;ll see all applicable event handlers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the user releases a key, the <code>onKeyReleased</code> method handler receives the <code>KeyEvent</code> object as an argument. The method <code>getCode</code> from the class <code>KeyEvent</code> returns the <code>KeyCode</code> object that represents the key pressed. For example, if you press the button Q, the <code>getCode</code> will return <code>Q</code>. If you press the arrow up, the <code>getCode</code> will return <code>UP</code>.</p>
</div>
<div class="paragraph">
<p>But the same key can result in displaying more than one character (e.g. Q or q) The method <code>getText</code> of <code>KeyEvent</code> returns a <code>String</code> that represents the character typed by the user.</p>
</div>
<div class="paragraph">
<p>To enable our GUI to react on keyboard events right after the program starts, we need to <em>set the focus</em> on the GUI. This was not required when we clicked on the GUI components with the mouse, but now we won&#8217;t even touch the screen.</p>
</div>
<div class="paragraph">
<p>To set the focus to the <code>Group</code> container we&#8217;ll need to do two things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable the <code>Group</code> to receive the focus by useing the attribute <code>focusTraversable="true"</code> in <em>pingpong.fxml</em>.</p>
</li>
<li>
<p>Right after the stage is displayed in the <code>PingPong</code> class, we&#8217;ll call the method <code>requestFocus</code> on the <code>Group</code> container. The method <code>start</code> in <code>PingPong</code> will look like this (I&#8217;ve added just the last line to the code generated by IDEA):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java"> public void start(Stage primaryStage) throws Exception{

  Parent root = FXMLLoader.load(getClass().getResource("pingpong.fxml"));

  primaryStage.setScene(new Scene(root, 400, 250));
  primaryStage.initStyle(StageStyle.UNDECORATED);

  primaryStage.show();
  root.requestFocus();
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_processing-keyboard-events-in-the-controller"><a class="anchor" href="#_processing-keyboard-events-in-the-controller"></a>Processing Keyboard Events in the Controller</h4>
<div class="paragraph">
<p>In the code that comes with this chapter the final version of the controller is called <code>PingPongController</code>. But I&#8217;ve also included multiple versions of the controller that gradually implement the steps listed in the game strategy. Each "intermediate" controller class name starts with <code>PingPongController</code> followed with a different suffix with a version number (e.g. <code>PingPongController_v1</code>, <code>PingPongController_v2</code> etc.) The starting comment in each  class briefly describes what was added in this version of the controller. To see any of these controllers in action, just specify its name as <code>fx:controller</code> in the file <code>pingpong.fxml</code> and run the <code>PingPong</code> program.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In InelliJ IDEA you can easily compare two files to see the difference. Press CTRL or CMD button and click on the names of two files you&#8217;d like to compare (e.g. <code>PingPongController_v1</code> and <code>PingPongController_v2</code>). Then select the menu View | Compare Two Files, and you&#8217;ll see the source code of these files next to each other with highlighted differences.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s add to the <code>PingPongControler</code> a method handler for the key-released events. The first very simple version of the <code>PingPongControler</code> is shown next. The goal is to see that the controller receives the keyboard events and can recognize the keys pressed by the player.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package pong;

import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

public class PingPongController {

  public void keyReleasedHandler(KeyEvent event){

    KeyCode keyCode =  event.getCode();
    System.out.println("You pressed " + keyCode);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event handler method just extracts the key code from the <code>KeyEvent</code> object provided by the Java runtime and prints it.
For example, after running the <code>PingPong</code> class and pressing the up and down arrows, <em>n</em>, <em>q</em>, and <em>s</em> keys, the console output should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html" data-lang="html">You pressed UP
You pressed DOWN
You pressed N
You pressed Q
You pressed S</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>KeyCode</code> in <code>PingPongController</code> is not a class or an interface, but a special Java construct called <code>enum</code> described next.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the-enum-type"><a class="anchor" href="#_the-enum-type"></a>The enum Type</h4>
<div class="paragraph">
<p>Our controller class declares a variable of type <code>KeyCode</code>, which is neither a class nor an interface. It&#8217;s a special Java data type <code>enum</code> used for declaring a bunch of pre-defined constants that never change. For example, you can declare a new <code>enum</code> type day-of-the-week:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public enum Day {
    SUNDAY, MONDAY, TUESDAY, WEDNESDAY,
    THURSDAY, FRIDAY, SATURDAY
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following class <code>GreetTheDay</code> illustrates the use of the <code>enum Day</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class GreetTheDay {

  public static void main(String[] args) {

    greet(Day.SATURDAY);
  }

  static void greet(Day day){
    switch (day) {
        case MONDAY:
            System.out.println("The week begins");
            break;
        case SATURDAY:
        case SUNDAY:
            System.out.println("Hello Weekend!");
            break;
        default:
            System.out.println("Hello Midweek");
            break;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>greet</code> expects to receive one of the <code>Day</code> values as an argument. Our <code>main</code> method wants to greet Saturday, and if you run the program <code>GreetTheDay</code> it&#8217;ll print <em>Hello Weekend!</em>.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ll open the <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/scene/input/KeyCode.html">online documentation</a> for <code>KeyCode</code> you&#8217;ll find there the declarations of all possible keyboard keys.</p>
</div>
</div>
<div class="sect3">
<h4 id="_preparing-to-process-the-keys-s-q-and-n"><a class="anchor" href="#_preparing-to-process-the-keys-s-q-and-n"></a>Preparing to Process the Keys S, Q, and N</h4>
<div class="paragraph">
<p>Now we&#8217;ll add a <code>switch</code> statement to the controller to invoke the method that corresponds to the pressed key. Let&#8217;s not worry about implementing the application logic just yet. We want to make sure that the programs invokes the correct method for each key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package pong;

import javafx.application.Platform;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

public class PingPongController {

  public void keyReleasedHandler(KeyEvent event){

    KeyCode keyCode = event.getCode();

    switch (keyCode){
      case UP:
          process_key_Up();
          break;
      case DOWN:
          process_key_Down();
          break;
      case N:
          process_key_N();
          break;
      case Q:
          Platform.exit(); // Terminate the app
          break;
      case S:
          process_key_S();
          break;
      }
  }

  private void process_key_Up() {
    System.out.println("Processing the Up key");
  }

  private void process_key_Down() {
    System.out.println("Processing the Down key");
  }

  private void process_key_N() {
    System.out.println("Processing the N key");
  }

  private void process_key_S() {
    System.out.println("Processing the S key");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>switch</code> statement checks the value of <code>enum KeyCode</code> and calls the corresponding method which just prints a hard-coded message - we&#8217;ll implement them shortly. But the Q-key in the above <code>PingPongController</code> is fully functional. When the user presses the Q-key, the program invokes the method <code>exit</code> on the class <code>Platform</code>, which terminates the program.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step-3-moving-the-paddle"><a class="anchor" href="#_step-3-moving-the-paddle"></a>Step 3: Moving the Paddle</h3>
<div class="paragraph">
<p>Now let&#8217;s teach the keys Up and Down to move the kid&#8217;s paddle vertically. Pressing the Up-arrow should move the kid&#8217;s paddle several pixels up according to the predefined moving increment. Pressing the Down-arrow should move the paddle down. We&#8217;ll declare an movement increment as a <code>final</code> variable in <code>PingPongController</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">final int PADDLE_MOVEMENT_INCREMENT = 6;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pressing the key once will change the vertical position of the paddle by 7 pixels. Seven is not a magical number, and you can use any other integer here.</p>
</div>
<div class="paragraph">
<p>The new version of the controller will use the <code>@FXML</code> annotations to inject the references to the GUI components. To update the position of the kid&#8217;s paddle on the GUI we&#8217;ll use data binding explained in Chapter 8. We&#8217;ll also add the method <code>initialize</code> that is invoked by the Java runtime once when the controller object is created. Finally, we&#8217;ll write the code in the methods <code>process_key_Down</code> and <code>process_key_Up</code> to move the kid&#8217;s paddle vertically.</p>
</div>
<div class="paragraph">
<p>In JavaFX the x and y coordinates of the top left corner of the stage have zero values. x-coordinate increases from left to right, and the y-coordinate increases from top to bottom. The following image shows how x and y coordinates change if a ping-pong table has the width of 400 pixels and the height of 250:</p>
</div>
<div id="FIG13-8" class="imageblock">
<div class="content">
<img src="./images/fig_13_table_coordinates.png" alt="fig 13 table coordinates">
</div>
</div>
<div class="paragraph">
<p>In our game the paddles can move only up or down, so depending on the key pressed we&#8217;ll be changing the value of the property <code>layoutY</code> of the right paddle, which will move it on stage accordingly. Here&#8217;s how the <code>PingPongController</code> will look now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package pong;

import javafx.application.Platform;
import javafx.beans.property.DoubleProperty;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.fxml.FXML;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;
import javafx.scene.shape.Circle;
import javafx.scene.shape.Rectangle;

public class PingPongController {

  final int PADDLE_MOVEMENT_INCREMENT = 6;

  DoubleProperty currentKidPaddleY =
              new SimpleDoubleProperty();   <i class="conum" data-value="1"></i><b>(1)</b>

  double allowedPaddleTopY;                 <i class="conum" data-value="2"></i><b>(2)</b>
  double allowedPaddleBottomY;

  @FXML Rectangle table;                    <i class="conum" data-value="3"></i><b>(3)</b>
  @FXML Rectangle compPaddle;
  @FXML Rectangle kidPaddle;
  @FXML Circle ball;

  public void initialize() {

    currentKidPaddleY.set(kidPaddle.getLayoutY());  <i class="conum" data-value="4"></i><b>(4)</b>
    kidPaddle.layoutYProperty().bind(currentKidPaddleY);

    allowedPaddleTopY = PADDLE_MOVEMENT_INCREMENT; <i class="conum" data-value="5"></i><b>(5)</b>
    allowedPaddleBottomY = table.getHeight() - kidPaddle.getHeight() - PADDLE_MOVEMENT_INCREMENT;

  }

  public void keyReleasedHandler(KeyEvent event){

    KeyCode keyCode = event.getCode();

    switch (keyCode){
        case UP:
            process_key_Up();
            break;
        case DOWN:
            process_key_Down();
            break;
        case N:
            process_key_N();
            break;
        case Q:
            Platform.exit(); // Terminate the application
            break;
        case S:
            process_key_S();
            break;
    }
  }

  private void process_key_Up() {      <i class="conum" data-value="6"></i><b>(6)</b>

    if (currentKidPaddleY.get() &gt; allowedPaddleTopY) {
        currentKidPaddleY.set(currentKidPaddleY.get() - PADDLE_MOVEMENT_INCREMENT);
    }
  }

  private void process_key_Down() {      <i class="conum" data-value="7"></i><b>(7)</b>

    if (currentKidPaddleY.get()&lt; allowedPaddleBottomY) {
        currentKidPaddleY.set(currentKidPaddleY.get() + PADDLE_MOVEMENT_INCREMENT);
    }
  }

  private void process_key_N() {
     System.out.println("Processing the N key");
  }

  private void process_key_S() {
     System.out.println("Processing the S key");
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Declaring the property <code>currentKidPaddleY</code> that will be bound to the property <code>layoutY</code> of the kid&#8217;s paddle.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The Kid will be moving the paddle up and down, but we don&#8217;t want to allow the paddle to leave the table boundaries. The variable <code>allowedPaddleTopY</code> will store the maximum allowed y-coordinate for the top of the paddle, and the <code>allowedPaddleBottomY</code> will have the maximum allowed y-coordinate for the bottom of the paddle.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Using the <code>@FXML</code> tag we inject the references to the GUI components defined in <em>pingpong.fxml</em> into the controller&#8217;s variables.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The method <code>initialize</code> in the controller is called only once and is the right place to initialize important variables. First, we initialize the property <code>currentKidPaddleY</code>, with the value of the <code>layoutY</code> property of the right paddle (the <em>kidPaddle</em> component has an attribute <code>layoutY="98.0"</code> in the file <em>pingpong.fxml</em>). Then we bind <code>currentKidPaddleY</code> to the  <code>layoutY</code> property of the GUI component kidPaddle.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Here we set the limits for the paddle movements. We set the variable <code>allowedPaddleTopY=PADDLE_MOVEMENT_INCREMENT</code> to make sure that if the Kid keeps pressing the Up arrow, the paddle will never cross the top border of the table. The bottom restriction <code>allowedPaddleBottomY</code> is calculated by subtracting the height of the paddle and <code>PADDLE_MOVEMENT_INCREMENT</code> from the table height.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The method <code>process_key_Up</code> gets the current y-coordinate of the top border of the paddle, and if it&#8217;s far enough from the table top, the code decrements the value of the property <code>currentKidPaddleY</code> by <code>PADDLE_MOVEMENT_INCREMENT</code>. Because <code>currentKidPaddleY</code> is bound to the <code>layoutY</code> property of the GUI component <code>kidPaddle</code>, the latter moves up on stage. The movement stops if the <code>currentKidPaddleY</code> value is higher than <code>allowedPaddleTopY</code>. Remember, the y-coordinate increases from top down, so the higher y-coordinates means that it&#8217;s physically lower on stage.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The method <code>process_key_Down</code> works similarly to <code>process_key_Up</code> but ensures that the paddle won&#8217;t cross the bottom border of the table.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now our controller knows how to move the Kid&#8217;s paddle. The next challenge is to learn how to move the ball.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step-4-moving-the-ball"><a class="anchor" href="#_step-4-moving-the-ball"></a>Step 4. Moving the Ball</h3>
<div class="paragraph">
<p>Let&#8217;s start implementing step 4 of the game strategy by calculating the starting position and painting the ball depending on the location of the right paddle.
When the user preses the S-key, we need to serve the ball from the position where the right paddle is currently located. Initially it&#8217;s located in the middle of the table, but the user may move it up or down before serving the ball.</p>
</div>
<div class="paragraph">
<p>The ball is represented by the shape <code>Circle</code>. From school math you should remember that a circle is represented by the coordinates of the center and the radius. In JavaFX the corresponding properties of the class <code>Circle</code> are called <code>centerX</code>, <code>centerY</code>, and <code>radius</code>. When the <code>Circle</code> is placed in a layout, its center gets the corresponding properties <code>layoutX</code> and <code>layoutY</code>.  By changing the coordinates of the center we can move the ball around the stage. Our ball is defined in the file <em>pingpong.fxml</em> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;Circle fx:id="ball" fill="#ff1f35" layoutX="191.0" layoutY="123.0" radius="9.0" stroke="BLACK" strokeType="INSIDE" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But why the above tag <code>&lt;Circle&gt;</code> doesn&#8217;t include <code>centerX</code> and <code>centerY</code>?  Actually we can and will replace the attributes <code>layoutX</code> and <code>layoutY</code> with <code>centerX</code> and <code>centerY</code> because we use the <code>Group</code> container that&#8217;s not a part of any other layout (e.g. <code>BorderPane</code> or <code>GridPane</code>). But JavaFX allows you to build complex scenes that can dynamically change sizes and reposition its child components.Hence the x and y coordinates of a component relative to a layout may not be the same as coordinates in the scene. For example, the actual x-coordinate of a component may be calculated by adding the x-coordinate of a container within a scene and the x-coordinate of the component within a container.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s modify the attributes of the tag <code>&lt;Circle&gt;</code> so it&#8217;ll look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;Circle fx:id="ball" fill="#ff1f35" centerX="191.0" centerY="123.0" radius="9.0" stroke="BLACK" strokeType="INSIDE" /&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_moving-the-ball-to-the-right-paddle"><a class="anchor" href="#_moving-the-ball-to-the-right-paddle"></a>Moving the Ball to the Right Paddle</h4>
<div class="paragraph">
<p>Since the ball will be moving, we&#8217;ll keep track of its center in the new properties <code>ballCenterX</code> and <code>ballCenterY</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">DoubleProperty ballCenterX = new SimpleDoubleProperty();
DoubleProperty ballCenterY = new SimpleDoubleProperty();</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the method <code>initialize</code> we&#8217;ll set the initial values of these properties to the center coordinates of the ball. We&#8217;ll also bind the above properties to the center of the <code>Circle</code>, so changing <code>ballCenterX</code> and <code>ballCenterY</code> will automatically change the location of the ball on the scene:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">ballCenterX.set(ball.getCenterX());
ballCenterY.set(ball.getCenterY());

ball.centerXProperty().bind(ballCenterX);
ball.centerYProperty().bind(ballCenterY);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s place the ball by the current position of the kid&#8217;s paddle. In the method <code>process_key_S</code> we&#8217;ll adjust the <code>centerY</code> coordinate of the ball. Our controller has the variable <code>currentKidPaddleY</code> that remembers the current y-coordinate of the top of the kid&#8217;s paddle. So if we&#8217;ll add to <code>currentKidPaddleY</code> the half of the the paddle&#8217;s height, we&#8217;ll get the the y-coordinate of the paddle&#8217;s center. The <code>centerX</code> coordinate will be the same as the <code>layoutX</code> of the Kid&#8217;s paddle.The new version of the method <code>process_key_S</code>  will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void process_key_S() {

  ballCenterY.set(currentKidPaddleY.doubleValue() + kidPaddle.getHeight()/2);
  ballCenterX.set(kidPaddle.getLayoutX());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>I ran the <code>PingPong</code> application, moved the paddle up by clicking the arrow key several times, and then pressed the S-key. The ball obediently moved to the current position of the right paddle:</p>
</div>
<div id="FIG13-9" class="imageblock">
<div class="content">
<img src="./images/fig_13_serve_ball.png" alt="fig 13 serve ball">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_serving-the-ball-horizontally"><a class="anchor" href="#_serving-the-ball-horizontally"></a>Serving the Ball Horizontally</h4>
<div class="paragraph">
<p>The ball is ready to start moving now. To make the movement smooth we&#8217;ll use the class <code>javafx.animation.Timeline</code> that allows change the values of the GUI component&#8217;s properties over a time interval. Similarly to a movie, the animation is a set of frames that are displayed over a specific period of time. Each frame is a snapshot of a GUI component at a certain state. For the ball movement we&#8217;ll declare the variable <code>timeline</code> of the type <code>TimeLine</code>, which we&#8217;ll use to display a set of snapshots of a ball at different positions along its trajectory.</p>
</div>
<div class="paragraph">
<p>Each frame is represented by a class <code>KeyFrame</code>. Each snapshot is a represented by the class <code>KeyValue</code>. Let&#8217;s write a method <code>moveTheBall</code> that will move the ball horizontally all the way to the left until the <code>centerX</code> will become equal to zero.  If we&#8217;ll be changing only the <code>centerX</code> property of the <code>Circle</code>, it&#8217;ll be moving horizontally.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void moveTheBall(){

  timeline = new Timeline();   <i class="conum" data-value="1"></i><b>(1)</b>
  timeline.setCycleCount(1);

  KeyValue keyValue = new KeyValue(ballCenterX, 0);  <i class="conum" data-value="2"></i><b>(2)</b>
  KeyFrame keyFrame = new KeyFrame(new Duration(1000), keyValue);   <i class="conum" data-value="3"></i><b>(3)</b>

  timeline.getKeyFrames().add(keyFrame);    <i class="conum" data-value="4"></i><b>(4)</b>

  timeline.play();      //    <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>First we create an instance of the <code>Timeline</code> object and invoke the <code>setCycleCount</code> requesting that the animation will be done only once. In this example we could have declared the variable <code>timeline</code> inside the method, but keeping this variable on the class level will allow me to programatically stop the animation that I&#8217;ll demonstrate in the next version of the method <code>moveTheBall</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Then we&#8217;ll create the <code>KeyValue</code> object to specify which changing value to display in frames. In this case we want the animation to change the x-coordinate of the ball center from its current value <code>ballCenterX</code> to zero.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We want the <code>KeyFrame</code> to reach the target (change the <code>centerX</code> specified in <code>KeyValue</code> from the current value to zero) over the period of 1000 milliseconds. The smaller the number, the faster the ball will move. The number of frames will be automatically calculated based on the duration and the target position of the ball.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Adding the our <code>KeyFrame</code> object to the timeline completes the preparations.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The method <code>play</code> will play the timeline.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now if you&#8217;ll invoke the method <code>moveTheBall</code> from <code>process_key_S</code> the ball will move to the left and stop there. Here&#8217;s what I&#8217;ve got after starting the game and pressing the S-key:</p>
</div>
<div id="FIG13-10" class="imageblock">
<div class="content">
<img src="./images/fig_13_ball_moved.png" alt="fig 13 ball moved">
</div>
</div>
<div class="paragraph">
<p>Our ball is not smart enough to notice that there was a left paddle on its way and went right through it. We&#8217;ll take care of the GUI component collisions a bit later.</p>
</div>
<div class="paragraph">
<p>Depending on the provided duration, the <code>Timeline</code> object will calculate how many snapshots (key frames) to create while the <code>KeyValue</code> is changing to reach the target. The <code>Timeline</code> class has several <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/animation/Timeline.html#constructor.summary">overloaded constructors</a>, and one of the allows to specify the frames per second for the animation.</p>
</div>
<div class="paragraph">
<p>The <code>KeyFrame</code> class also has several <a href="http://docs.oracle.com/javase/8/javafx/api/javafx/animation/KeyFrame.html#constructor.summary">overloaded constructors</a>, and one of them allows you to specify the duration, the event handler for the <code>ActionEvent</code>, and optional key value(s). The handler for the <code>ActionEvent</code> can be implemented as a  lambda expression.</p>
</div>
<div class="paragraph">
<p>In the following version of the method <code>moveTheBall</code> we&#8217;ll write the code to advance the ball at the specified increments.  We&#8217;ll also use different constructors of <code>TimeLine</code> and <code>KeyFrame</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">final int BALL_MOVEMENT_INCREMENT = 5;

private void moveTheBall(){

  KeyFrame keyFrame = new KeyFrame(new Duration(10),   <i class="conum" data-value="1"></i><b>(1)</b>
      event -&gt; {

        if (ballCenterX.get() &gt; BALL_MOVEMENT_INCREMENT) { <i class="conum" data-value="2"></i><b>(2)</b>

               ballCenterX.set(ballCenterX.get() - BALL_MOVEMENT_INCREMENT);       <i class="conum" data-value="3"></i><b>(3)</b>

        } else {
           timeline.stop();                           <i class="conum" data-value="4"></i><b>(4)</b>
        }
      }
  );

  timeline = new Timeline(keyFrame);             <i class="conum" data-value="5"></i><b>(5)</b>
  timeline.setCycleCount(Timeline.INDEFINITE);
  timeline.play();

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first argument of the constructor is the <code>Duration</code> object, but this time it has different meaning than in the previous version of the <code>moveTheBall</code>. The value of 10 means to run the code from the event handler (the lambda expression) every 10 milliseconds.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The lambda expression starts with checking if the current value of the x-coordinate of the ball center is larger than the value in <code>BALL_MOVEMENT_INCREMENT</code> to ensure that the ball will not cross the left border and will stay at the 0 coordinates. To make our game more realistic, we&#8217;ll let the ball go off the table in the next version of the <code>moveTheBall</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decrement the value of the <code>ballCenterX</code> by <code>BALL_MOVEMENT_INCREMENT</code>. Because of binding this will move the ball on the GUI.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Stop the animation if the ball would fall off the table on the next move.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Create the <code>Timeline</code> using our <code>KeyFrame</code> and play it. In this case I requested to play the animation indefinitely, because I don&#8217;t want to calculate how many moves would it take to reach the target position. I&#8217;ll stop the animation manually anyway as explained in step 4.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_serving-the-ball-in-random-directions"><a class="anchor" href="#_serving-the-ball-in-random-directions"></a>Serving the Ball in Random Directions</h4>
<div class="paragraph">
<p>The game that serves the ball horizontally is pretty boring, so let&#8217;s change not only the x-, but y-coordinate as well while the ball is moving. To add some fun, let&#8217;s change the y-coordinate in a random manner, so each ball serving sends the ball in a different direction. We&#8217;ll create a ball serving machine.</p>
</div>
<div class="paragraph">
<p>If the user moved the paddle to the upper half of the table, the ball should be moving either horizontally or down. If the ball is served from the lower half - the ball can move either horizontally or upward. To know the y-coordinate of the table center we&#8217;ll declare the <code>double</code> variable <code>centerTableY</code> and set its value in the method <code>initialize</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">centerTableY = table.getHeight()/2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the ball moves, we&#8217;ll modified value of the y-coordinate of the ball center will be assigning it to the property <code>ballCenterY</code>.The following version version of the method <code>moveTheBall</code> implements the random ball servings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">  private void moveTheBall(){

        Random randomYGenerator = new Random();
        double randomYincrement = randomYGenerator.nextInt(BALL_MOVEMENT_INCREMENT);         <i class="conum" data-value="1"></i><b>(1)</b>

        final boolean isServingFromTop = (ballCenterY.get() &lt;= centerTableY)?true:false;      <i class="conum" data-value="2"></i><b>(2)</b>


        KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {

            if (ballCenterX.get() &gt;= -20) {    <i class="conum" data-value="3"></i><b>(3)</b>

                ballCenterX.set(ballCenterX.get() - BALL_MOVEMENT_INCREMENT);

                if (isServingFromTop) {       <i class="conum" data-value="4"></i><b>(4)</b>
                    ballCenterY.set(ballCenterY.get() + randomYincrement);

                } else {
                    ballCenterY.set(ballCenterY.get() + randomYincrement);
                }

            } else {
                timeline.stop();

            }

        });

        timeline = new Timeline(keyFrame);
        timeline.setCycleCount(Timeline.INDEFINITE);

        timeline.play();

    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create an instance of the class <code>java.util.Random</code>. This class has methods to generate random numbers of different types. Invoking the method <code>nextInt</code> generates a random integer number in the range between zero and the value of the method argument. I decided to use the value of <code>BALL_MOVEMENT_INCREMENT</code> as a top limit. This random number will be used as an increment for the y-coordinate of the moving ball.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Using the conditional operator (it&#8217;s explained in Chapter 4) we set the variable <code>isServingFromTop</code> to true if the right paddle is located on the upper half of the table, or to false if the paddle is in the lower half.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In the previous version of the method <code>moveTheBall</code> we were keeping the ball on the table when it was reaching the left edge of the table. Now we let the ball fall off the table. The <code>-20</code> is just an arbitrary number - we stop the ball movement after the ball moved 20 pixels past the left table edge. In the final version of the game we&#8217;ll enable the movement for the left paddle, and sometimes it&#8217;ll bounce the ball back.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If <code>isServingFromTop</code> is true, we&#8217;re increasing the y-coordinate of the ball&#8217;s center by <code>randomYincrement</code>, otherwise we&#8217;re decreasing it by the same amount. Now the ball will be served in an unpredictable manner and will pretty often fall off the table crossing the top or bottom edge of the table. I took the following screen shot when the moving ball was about to cross the bottom edge of the table.</td>
</tr>
</table>
</div>
<div id="FIG13-11" class="imageblock">
<div class="content">
<img src="./images/fig_13_ball_moved_down.png" alt="fig 13 ball moved down">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step-5-moving-the-computer-s-paddle"><a class="anchor" href="#_step-5-moving-the-computer-s-paddle"></a>Step 5: Moving the Computer&#8217;s Paddle</h3>
<div class="paragraph">
<p>When the ball is served, the Computer needs to move its paddle in the right direction to bounce the ball. This is a pretty easy task since the computer knows that if the Kid&#8217;s paddle served from the top, the ball will move down, and if the ball was served from the bottom it&#8217;ll move up. So the moment the ball is served, the computer&#8217;s paddle should also start moving.</p>
</div>
<div class="paragraph">
<p>First of all, we&#8217;ll declare the property <code>currentComputerPaddleY</code> to keep track of the y-coordinate of the Computer&#8217;s paddle. We&#8217;ll also need to store the initial y-coordinate of the Computer&#8217;s paddle, because on each ball serving this paddle should be in the middle of the left side f the table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">DoubleProperty currentComputerPaddleY = new SimpleDoubleProperty();

double initialComputerPaddleY;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the method <code>initialize</code> we&#8217;ll bind <code>currentComputerPaddleY</code> to the <code>layoutY</code> property of the <code>Rectangle</code> that represents the Computer&#8217;s paddle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">initialComputerPaddleY = compPaddle.getLayoutY();

currentComputerPaddleY.set(initialComputerPaddleY);
compPaddle.layoutYProperty().bind(currentComputerPaddleY);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new version of the method <code>moveTheBall</code> will start the movement of the Computer&#8217;s paddle in the right direction as soon as the ball is served.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void moveTheBall(){

  Random randomYGenerator = new Random();
  double randomYincrement = randomYGenerator.nextInt(BALL_MOVEMENT_INCREMENT);

  final boolean isServingFromTop = (ballCenterY.get() &lt;= centerTableY)?true:false;

  KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {

    if (ballCenterX.get() &gt;= -20) {

        ballCenterX.set(ballCenterX.get() - BALL_MOVEMENT_INCREMENT);

        if (isServingFromTop) {
          ballCenterY.set(ballCenterY.get() + randomYincrement);

          currentComputerPaddleY.set( currentComputerPaddleY.get() + 1);       <i class="conum" data-value="1"></i><b>(1)</b>

        } else {
          ballCenterY.set(ballCenterY.get() - randomYincrement);

          currentComputerPaddleY.set(currentComputerPaddleY.get() - 1);      <i class="conum" data-value="2"></i><b>(2)</b>
        }

    } else {
        timeline.stop();

        currentComputerPaddleY.set(initialComputerPaddleY);  <i class="conum" data-value="3"></i><b>(3)</b>
    }
  });

  timeline = new Timeline(keyFrame);
  timeline.setCycleCount(Timeline.INDEFINITE);

  timeline.play();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the ball was served from the top, move the Computer&#8217;s paddle one pixel down on each frame.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If the ball was served from the lower half of the table, move the Computer&#8217;s paddle one pixel up on each frame.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When the ball stops moving, return the Computer&#8217;s paddle to the initial position in the middle of the left side of the table.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step-6-bouncing-the-ball"><a class="anchor" href="#_step-6-bouncing-the-ball"></a>Step 6: Bouncing the Ball</h3>
<div class="paragraph">
<p>There is no guarantee that the Computer&#8217;s paddle will be advanced to the position to bounce the ball. Our Ping-Pong game doesn&#8217;t implement the algorithm the adjust the movement of the Computer&#8217;s paddle based on the trajectory of the ball&#8217;s movement. But if the ball accidentally contacts the paddle we need to bounce the ball and send it from left to right.</p>
</div>
<div class="paragraph">
<p>Every JavaFX GUI component is a subclass of a <code>Node</code>, which has a special property <code>boundsInParent</code>. It&#8217;s an invisible rectangle that encapsulates the component when it&#8217;s places inside a layout. So our ball and paddles are is sitting inside of these invisible rectangle too. When the ball or paddles are being moved, the coordinates of their <code>boundsInParent</code> properties are being recalculated. If these invisible rectangles of the ball and the paddle intersect, we can say that there was a contact. The method <code>checkForBallPaddleContact</code> returns true if there was a contact, and false if not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private boolean checkForBallPaddleContact(){

  if (ball.intersects(compPaddle.getBoundsInParent())){
      return true;
  } else {
       return false;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We should call this method from each frame in the timeline that we started in the method <code>moveTheBall</code>. After this check for contact to the method <code>moveTheBall</code> it&#8217;ll look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void moveTheBall(){

  Random randomYGenerator = new Random();
  double randomYincrement = randomYGenerator.nextInt(BALL_MOVEMENT_INCREMENT);

  final boolean isServingFromTop = (ballCenterY.get() &lt;= centerTableY)?true:false;

  KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {
    if (ballCenterX.get() &gt;= -20) {

        ballCenterX.set(ballCenterX.get() - BALL_MOVEMENT_INCREMENT);

        if (isServingFromTop) {
          ballCenterY.set(ballCenterY.get() + randomYincrement);

          currentComputerPaddleY.set( currentComputerPaddleY.get() + 1);

        } else {
          ballCenterY.set(ballCenterY.get() - randomYincrement);

          currentComputerPaddleY.set(currentComputerPaddleY.get() - 1);
        }

        if (checkForBallPaddleContact()){

          timeline.stop();               <i class="conum" data-value="1"></i><b>(1)</b>
          currentComputerPaddleY.set(initialComputerPaddleY);

          bounceTheBall();               <i class="conum" data-value="2"></i><b>(2)</b>
         };

    } else {
        timeline.stop();
        currentComputerPaddleY.set(initialComputerPaddleY);
    }
  });

  timeline = new Timeline(keyFrame);
  timeline.setCycleCount(Timeline.INDEFINITE);

  timeline.play();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If there was a ball/paddle contact, we need to stop playing the current <code>timeline</code>, set the Computer&#8217;s paddle to its initial position.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>&lt;2&gt;Then we&#8217;ll need to call the method <code>bounceTheBall</code>, which we&#8217;ll write next.</p>
</div>
<div class="paragraph">
<p>According to step 6 in our game strategy, the computer can only serve the ball horizontally, so writing the <code>bounceTheBall</code> method seems like a pretty simple thing to do. We already wrote a version of the <code>moveTheBall</code> method that sends the ball horizontally from right to left, so just reversing the ball moving direction should be easy.</p>
</div>
<div class="paragraph">
<p>But what if the Kid will move his or her paddle to hit the ball back? OK, then we need to be checking if the ball contacts the Kid&#8217;s paddle too. Can we reuse the method <code>checkForBallPaddleContact</code> for this? Not in its current form, because it&#8217;s written specifically for the computer paddle. We can certainly write a similar method for the Kid&#8217;s paddle and have two almost identical methods, but it&#8217;s better to re-write <code>checkForBallPaddleContact</code> to work for both paddles.</p>
</div>
<div class="paragraph">
<p>In programmer&#8217;s jargon re-writing an existing and working code is called <em>refactoring</em>. So let&#8217;s refactor the method <code>checkForBallPaddleContact</code> by providing the paddle as an argument. Here&#8217;s the refactored version that can be used for both p:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private boolean checkForBallPaddleContact(Rectangle paddle){

    if (ball.intersects(paddle.getBoundsInParent())){
        return true;
    } else {
         return false;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Accordingly, the method <code>moveTheBall</code> would check for the contact with Computer&#8217;s paddle as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">checkForBallPaddleContact(compPaddle);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To check for the ball contact with the Kid&#8217;s paddle you&#8217;d write this line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">checkForBallPaddleContact(kidPaddle);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s write the method <code>bounceTheBall</code>, which should be very similar to <code>moveTheBall</code>. The ball should move from left to write, if  you&#8217;ve been decreasing the x-coordinate in <code>moveTheBall</code>, you&#8217;ll need to decrease it now. If you&#8217;ve been stopping the game where the coordinate of the ball was less than -20, now it has to be more that the table width plus 20. I could refactor the method <code>moveTheBall</code> to introduce these values as methods arguments, but let&#8217;s keep it as a small project for you. As long as you understand how the code works, you should be able to do it on your own. Here&#8217;s the code of the method <code>bounceTheBall</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void bounceTheBall() {

  double theBallOffTheTableX = table.getWidth() + 20;  <i class="conum" data-value="1"></i><b>(1)</b>

  KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {

    System.out.println(ballCenterX);
    if (ballCenterX.get() &lt; theBallOffTheTableX) {

       ballCenterX.set(ballCenterX.get() + BALL_MOVEMENT_INCREMENT);              <i class="conum" data-value="2"></i><b>(2)</b>

       if (checkForBallPaddleContact(kidPaddle)){   <i class="conum" data-value="3"></i><b>(3)</b>
           timeline.stop();
           moveTheBall();
        };

    } else {
       timeline.stop();
    }

  });

  timeline = new Timeline(keyFrame);
  timeline.setCycleCount(Timeline.INDEFINITE);

  timeline.play();

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The ball should stop its movement when its x-coordinate is 20 pixels to the right of the table.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Advance the ball to the right until its x-coordinate reaches the value of <code>theBallOffTheTableX</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>While the Computer bounces the ball, the Kid can press the up and down arrow keys to stop the ball. If the ball contacts the Kid&#8217;s paddle, we call the <code>moveTheBall</code> method to start the random movement to the left again.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The basic functionality of the game is implemented except displaying the game score and starting the new game when one of the players gets 21 points. I leave this part for you to implement on your own.</p>
</div>
<div class="paragraph">
<p>I&#8217;ve been showing and explaining various code fragments of the <code>PingPongController</code> as we&#8217;ve been implementing the game strategy one step at a time. Now I&#8217;ll just show how the code of the <code>PingPongConroller</code> class looks without any additional explanations. You should be able to read and understand the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package pong;

import javafx.animation.KeyFrame;
import javafx.animation.Timeline;
import javafx.application.Platform;
import javafx.beans.property.DoubleProperty;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.fxml.FXML;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;
import javafx.scene.shape.Circle;
import javafx.scene.shape.Rectangle;
import javafx.util.Duration;

import java.util.Random;


// This code implements 6 steps of the Game strategy

public class PingPongController {

 final int PADDLE_MOVEMENT_INCREMENT = 7;
 final int BALL_MOVEMENT_INCREMENT = 3;

 double centerTableY;

 DoubleProperty currentKidPaddleY = new SimpleDoubleProperty();
 DoubleProperty currentComputerPaddleY = new SimpleDoubleProperty();
 double initialComputerPaddleY;

 DoubleProperty ballCenterX = new SimpleDoubleProperty();
 DoubleProperty ballCenterY = new SimpleDoubleProperty();

 double allowedPaddleTopY;
 double allowedPaddleBottomY;

 Timeline timeline;

 @FXML
 Rectangle table;
 @FXML  Rectangle compPaddle;
 @FXML  Rectangle kidPaddle;
 @FXML  Circle ball;

 public void initialize()
 {

     currentKidPaddleY.set(kidPaddle.getLayoutY());
     kidPaddle.layoutYProperty().bind(currentKidPaddleY);

     ballCenterX.set(ball.getCenterX());
     ballCenterY.set(ball.getCenterY());

     ball.centerXProperty().bind(ballCenterX);
     ball.centerYProperty().bind(ballCenterY);


     initialComputerPaddleY = compPaddle.getLayoutY();
     currentComputerPaddleY.set(initialComputerPaddleY);
     compPaddle.layoutYProperty().bind(currentComputerPaddleY);


     allowedPaddleTopY = PADDLE_MOVEMENT_INCREMENT;
     allowedPaddleBottomY = table.getHeight() - kidPaddle.getHeight() - PADDLE_MOVEMENT_INCREMENT;

     centerTableY = table.getHeight()/2;
 }
 public void keyReleasedHandler(KeyEvent event){

     KeyCode keyCode = event.getCode();

     switch (keyCode){
         case UP:
             process_key_Up();
             break;
         case DOWN:
             process_key_Down();
             break;
         case N:
             process_key_N();
             break;
         case Q:
             Platform.exit(); // Terminate the application
             break;
         case S:
             process_key_S();
             break;
     }
 }


 private void process_key_Up() {

     if (currentKidPaddleY.get() &gt; allowedPaddleTopY) {
         currentKidPaddleY.set(currentKidPaddleY.get() - PADDLE_MOVEMENT_INCREMENT);
     }
 }

 private void process_key_Down() {

     if (currentKidPaddleY.get()&lt; allowedPaddleBottomY) {
         currentKidPaddleY.set(currentKidPaddleY.get() + PADDLE_MOVEMENT_INCREMENT);
     }
 }

 private void process_key_N() {
     System.out.println("Processing the N key");
 }

 private void process_key_S() {

     ballCenterY.set(currentKidPaddleY.doubleValue() + kidPaddle.getHeight()/2);
     ballCenterX.set(kidPaddle.getLayoutX());

     moveTheBall();
 }

 private void moveTheBall(){

     Random randomYGenerator = new Random();
     double randomYincrement = randomYGenerator.nextInt(BALL_MOVEMENT_INCREMENT);

     final boolean isServingFromTop = (ballCenterY.get() &lt;= centerTableY)?true:false;

     KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {

         if (ballCenterX.get() &gt;= -20) {

             ballCenterX.set(ballCenterX.get() - BALL_MOVEMENT_INCREMENT);

             if (isServingFromTop) {
                 ballCenterY.set(ballCenterY.get() + randomYincrement);

                 currentComputerPaddleY.set( currentComputerPaddleY.get() + 1);

             } else {
                 ballCenterY.set(ballCenterY.get() - randomYincrement);

                 currentComputerPaddleY.set(currentComputerPaddleY.get() - 1);
             }

             if (checkForBallPaddleContact(compPaddle)){
                 timeline.stop();
                 currentComputerPaddleY.set(initialComputerPaddleY);
                 bounceTheBall();
             };

         } else {
             timeline.stop();

             currentComputerPaddleY.set(initialComputerPaddleY);
         }
     });

     timeline = new Timeline(keyFrame);
     timeline.setCycleCount(Timeline.INDEFINITE);

     timeline.play();
 }


 private boolean checkForBallPaddleContact(Rectangle paddle){

     if (ball.intersects(paddle.getBoundsInParent())){
         return true;
     } else {
          return false;
     }
 }

 private void bounceTheBall() {

     double theBallOffTheTableX = table.getWidth() + 20;

     KeyFrame keyFrame = new KeyFrame(new Duration(10), event -&gt; {

         if (ballCenterX.get() &lt; theBallOffTheTableX) {

             ballCenterX.set(ballCenterX.get() + BALL_MOVEMENT_INCREMENT);

             if (checkForBallPaddleContact(kidPaddle)){
                 timeline.stop();
                 moveTheBall();
             };

         } else {
             timeline.stop();
         }

     });

     timeline = new Timeline(keyFrame);
     timeline.setCycleCount(Timeline.INDEFINITE);

     timeline.play();

   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_project-displaying-the-game-score"><a class="anchor" href="#_project-displaying-the-game-score"></a>Project: Displaying the Game Score</h3>
<div class="paragraph">
<p>The goal of this project is to keep track and display the game score. I&#8217;ll just show you how to print the score on the system console, but you&#8217;ll need research how to display the text right on the ping-pong table.</p>
</div>
<div class="paragraph">
<p>If the Kid would serve the ball horizontally, he or she would score one point when the ball goes off the table and its x-coordinate is less than zero. But since the ball is served in a random direction, it can go off the table by crossing top or bottom table&#8217;s borders. In this case the Kid loses the point. When the method <em>moveTheBall</em> stops playing the timeline, the ball&#8217;s x-coordinate is definitely less than zero. So we need to check the y-coordinate of the ball.</p>
</div>
<div class="paragraph">
<p>If the y-coordinate of the ball has a value between zero and the table height, we can assume that the ball crossed the left border of the table and the Kid scores one point.
Otherwise the ball crossed either top or bottom table&#8217;s borders and the Kid should loose the point.</p>
</div>
<div class="paragraph">
<p>The Computer scores one point if it bounces the ball and it crosses the right border of the table.</p>
</div>
<div class="paragraph">
<p>You need to declare two class variable to keep track of the Computer&#8217;s and Kid&#8217;s scores:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">int computerScore;
int kidScore;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll also need to write a method <code>updateScore</code> and invoke it every time the timeline stops playing (in both methods: <code>moveTheBall</code> and <code>bounceTheBall</code> ). The method <code>updateScore</code> can look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private void updateScore(){

  if (ballCenterX.get() &gt; table.getWidth()){
      // Computer bounced the ball and the Kid didn't hit it back
      computerScore ++;
  } else if (ballCenterY.get() &gt; 0 &amp;&amp; ballCenterY.get() &lt;= table.getHeight()){
      // The Kid served the ball and Computer didn't hit it back
      kidScore++;
  } else{
      // The Kid served the ball off the table
      computerScore++;
  }


  System.out.println("Computer: " + computerScore + ", Kid: " + kidScore);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code that comes with the book has this version of the method <code>updateScore</code> implemented. Your goal is to display the score in a nice font on the bottom left corner of the table. you can learn how to work with the <code>Text</code> and <code>Font</code> classes by studying Oracle&#8217;s tutorial <a href="http://docs.oracle.com/javase/8/javafx/user-interface-tutorial/text.htm#JFXUI734">"Working with Text in JavaFX Applications"</a>.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to implement the Start New Game functionality. You&#8217;ll need to write a method <code>newGame</code>, where you should reset the scores and place the paddles and the ball in the starting positions.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-04-27 15:34:58 EDT
</div>
</div>
</body>
</html>